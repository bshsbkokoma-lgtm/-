<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö - ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for better aesthetics and responsiveness */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border-radius: 1rem;
            background-color: white;
            padding: 1.5rem;
            max-width: 90%;
            margin: 2rem auto;
            animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .result-box {
            background-color: #ffe4e6; /* Rose 100 */
            border: 2px solid #fda4af; /* Rose 300 */
            color: #e11d48; /* Rose 600 */
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: bold;
            font-size: 1.5rem;
        }
        /* Style for the secret header, ensuring it looks like normal text */
        #main-header {
            cursor: default; 
            user-select: none; /* Prevents text selection on repeated click */
        }
        /* Style for preventing background scroll when modal is active */
        .overflow-hidden-body {
            overflow: hidden !important;
        }
    </style>
</head>
<body id="body">

    <div id="app" class="min-h-screen flex flex-col items-center pt-8 pb-8">

        <!-- Main Love Calculator Card (User View) -->
        <div class="card w-full lg:w-1/2">
            <!-- This is the secret trigger element -->
            <h1 id="main-header" class="text-3xl font-extrabold text-center text-pink-600 mb-6">
                ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö üíñ
            </h1>
            <p class="text-center text-gray-500 mb-6">
                ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÑ‡∏´‡∏ô!
            </p>

            <form id="love-form" class="space-y-4">
                <div>
                    <label for="user-name" class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì:</label>
                    <input type="text" id="user-name" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏Å‡πà"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-pink-500 focus:border-pink-500 transition duration-150">
                </div>
                <div>
                    <label for="crush-name" class="block text-sm font-medium text-gray-700 mb-1">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö:</label>
                    <input type="text" id="crush-name" required placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏Ç‡πà"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-pink-500 focus:border-pink-500 transition duration-150">
                </div>
                <button type="submit" id="submit-button"
                        class="w-full py-3 px-4 bg-pink-600 text-white font-bold rounded-lg hover:bg-pink-700 transition duration-200 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:ring-offset-2">
                    ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô!
                </button>
            </form>

            <!-- Result Display -->
            <div id="result-container" class="mt-6 hidden">
                <div class="result-box" id="result-text"></div>
            </div>

            <!-- Custom Modal for Messages (No alert/confirm) -->
            <div id="message-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                    <p id="modal-message" class="text-gray-600 mb-4"></p>
                    <button onclick="closeModal('message-modal')"
                            class="w-full py-2 bg-pink-500 text-white rounded-lg hover:bg-pink-600">
                        ‡∏ï‡∏Å‡∏•‡∏á
                    </button>
                </div>
            </div>

             <!-- Admin Key Input Modal -->
             <div id="admin-key-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50">
                <div class="bg-white p-6 rounded-xl shadow-2xl max-w-lg w-full">
                    <h3 class="text-xl font-bold text-gray-800 mb-3 text-center">üîê ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á</h3>
                    <p class="text-gray-600 mb-4 text-sm">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á (Admin Key) ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</p>
                    <input type="password" id="admin-key-input" placeholder="Admin Key"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-pink-500 focus:border-pink-500 transition duration-150 mb-4">
                    <div class="flex space-x-2">
                        <button id="admin-key-submit"
                                class="flex-1 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700 transition duration-200">
                            ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                        </button>
                        <button onclick="closeModal('admin-key-modal')"
                                class="flex-1 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition duration-200">
                            ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Admin View Panel (Creator Only) -->
        <div id="admin-panel" class="card w-full lg:w-3/4 mt-8 hidden">
            <h2 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á)</h2>
            <p id="admin-info" class="text-sm text-gray-500 mb-4">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•... (User ID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <span id="current-user-id" class="font-mono text-xs bg-gray-100 p-1 rounded">N/A</span>)</p>
            <div id="matches-list" class="space-y-3">
                <!-- Data will be injected here -->
                <p class="text-center text-gray-400" id="no-data-msg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</p>
            </div>
        </div>

    </div>

    <!-- Firebase SDK Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, addDoc, onSnapshot, collection, query, serverTimestamp, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : null;
        // Fix: Ensure the initialAuthToken is correctly assigned from the global variable
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null; 

        // --- HARDCODED ADMIN KEY ---
        const CREATOR_ADMIN_KEY = '2552'; 

        let db, auth, userId = 'loading';
        let isAdminLoggedIn = false; 

        // Variables for the triple-click detection
        let clickCount = 0;
        let lastClickTime = 0;
        const TRIPLE_CLICK_INTERVAL = 400; // milliseconds

        // Set log level for debugging Firestore issues
        setLogLevel('Debug');

        // --- Utility Functions (Fixed to manage body scroll reliably) ---
        
        function openModal(modalId) {
            // Close other modals first (safety check against stuck overlays)
            document.getElementById('message-modal').classList.add('hidden');
            document.getElementById('admin-key-modal').classList.add('hidden');
            
            // Add scroll lock to body
            document.getElementById('body').classList.add('overflow-hidden-body');
            
            // Show the requested modal
            document.getElementById(modalId).classList.remove('hidden');
        }

        window.closeModal = function(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            // Remove scroll lock from body
            document.getElementById('body').classList.remove('overflow-hidden-body');
        }

        function showMessage(message) {
            document.getElementById('modal-message').textContent = message;
            openModal('message-modal');
        }

        function getRandomCompatibility() {
            // Generates a compatibility percentage between 40% and 100%
            return Math.floor(Math.random() * (100 - 40 + 1)) + 40;
        }

        // --- Firebase Initialization and Authentication ---

        if (firebaseConfig) {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);

            // Handle Authentication and set up listeners
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                    document.getElementById('current-user-id').textContent = userId;
                } else {
                    // Sign in with custom token if available, otherwise sign in anonymously
                    try {
                        if (initialAuthToken) {
                            await signInWithCustomToken(auth, initialAuthToken);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (error) {
                        console.error("Firebase Auth Error:", error);
                        showMessage("‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Firebase ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
                    }
                }
            });

        } else {
            console.error("Firebase configuration is missing.");
            showMessage("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡πÅ‡∏ï‡πà‡πÅ‡∏≠‡∏õ‡∏¢‡∏±‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ)");
        }

        // --- Firestore Data Functions ---

        /**
         * Saves the match result to the public Firestore collection.
         */
        async function saveMatch(userName, crushName, compatibility) {
            if (!db || userId === 'loading') {
                console.warn("Firestore not ready or user ID is loading. Data not saved.");
                return;
            }

            // Path for public data: /artifacts/{appId}/public/data/crush_matches
            const collectionPath = `artifacts/${appId}/public/data/crush_matches`;

            try {
                await addDoc(collection(db, collectionPath), {
                    userName: userName,
                    crushName: crushName,
                    compatibility: compatibility,
                    timestamp: serverTimestamp(),
                    submittedBy: userId,
                });
                console.log("Match data saved successfully.");
            } catch (e) {
                console.error("Error adding document: ", e);
                showMessage("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + e.message);
            }
        }

        /**
         * Sets up a real-time listener for the Admin Panel.
         * This function should only be called after the Admin Key is validated.
         */
        function setupAdminDataListener() {
            if (!db) return;

            const collectionPath = `artifacts/${appId}/public/data/crush_matches`;
            const q = query(collection(db, collectionPath));

            onSnapshot(q, (snapshot) => {
                const matchesListDiv = document.getElementById('matches-list');
                const noDataMsg = document.getElementById('no-data-msg');
                let htmlContent = '';
                let hasData = false;

                snapshot.docs.forEach((doc) => {
                    hasData = true;
                    const data = doc.data();
                    const timestamp = data.timestamp ? new Date(data.timestamp.seconds * 1000).toLocaleString('th-TH', { dateStyle: 'short', timeStyle: 'short' }) : '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡πÄ‡∏ß‡∏•‡∏≤';

                    // Display all sensitive information for the creator
                    htmlContent += `
                        <div class="p-3 bg-gray-50 border border-gray-200 rounded-lg text-sm">
                            <p class="font-semibold text-gray-800">${data.userName} ‡πÅ‡∏≠‡∏ö‡∏ä‡∏≠‡∏ö ${data.crushName}</p>
                            <p class="text-pink-600">‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô: ${data.compatibility}%</p>
                            <p class="text-xs text-gray-500">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${timestamp} | User ID: ${data.submittedBy}</p>
                        </div>
                    `;
                });

                matchesListDiv.innerHTML = htmlContent;

                if (hasData) {
                    noDataMsg.classList.add('hidden');
                } else {
                    noDataMsg.classList.remove('hidden');
                    matchesListDiv.innerHTML = ''; // Ensure list is cleared if no data
                }
            }, (error) => {
                console.error("Error listening to collection: ", error);
                matchesListDiv.innerHTML = `<p class="text-red-500">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${error.message}</p>`;
            });
        }


        // --- Event Listeners and Main Logic ---

        document.getElementById('love-form').addEventListener('submit', async function(event) {
            event.preventDefault();

            const userName = document.getElementById('user-name').value.trim();
            const crushName = document.getElementById('crush-name').value.trim();

            if (userName === "" || crushName === "") {
                showMessage("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì");
                return;
            }

            // 1. Calculate and Display Result (The part the user sees)
            const compatibility = getRandomCompatibility();
            const resultText = document.getElementById('result-text');
            const resultContainer = document.getElementById('result-container');

            resultText.innerHTML = `
                <div class="text-3xl font-extrabold">${userName} & ${crushName}</div>
                <div class="mt-2 text-6xl font-black">${compatibility}%</div>
                <div class="mt-2 text-xl">${getCompatibilityMessage(compatibility)}</div>
            `;
            resultContainer.classList.remove('hidden');

            // 2. Save data to Firestore (The part only the creator sees)
            await saveMatch(userName, crushName, compatibility);

            // Clear the form after submission
            document.getElementById('love-form').reset();
        });

        /**
         * Provides a fun message based on the percentage.
         */
        function getCompatibilityMessage(percent) {
            if (percent >= 90) return "‡∏ß‡πâ‡∏≤‡∏ß! ‡∏û‡∏£‡∏´‡∏°‡∏•‡∏¥‡∏Ç‡∏¥‡∏ï‡∏ä‡∏±‡∏î‡πÜ! ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏¢‡∏ß‡∏î! üíç";
            if (percent >= 75) return "‡∏™‡∏∏‡∏î‡∏¢‡∏≠‡∏î! ‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏î‡∏µ‡∏°‡∏≤‡∏Å ‡∏•‡∏≠‡∏á‡∏ó‡∏±‡∏Å‡πÑ‡∏õ‡∏Ñ‡∏∏‡∏¢‡∏î‡∏π‡πÄ‡∏•‡∏¢‡πÑ‡∏´‡∏°? üí¨";
            if (percent >= 60) return "‡∏û‡∏≠‡∏î‡∏µ‡πä‡∏û‡∏≠‡∏î‡∏µ! ‡∏°‡∏µ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏π‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏≠‡∏µ‡∏Å‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞! ‚ú®";
            if (percent >= 40) return "‡∏Å‡πá... ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô! üòâ";
            return "‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≥ ‡πÅ‡∏ï‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏ß‡∏±‡∏î‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ô‡∏∞! ‡∏™‡∏π‡πâ‡πÜ! üí™";
        }

        // --- Triple Click Admin Trigger Logic ---
        document.getElementById('main-header').addEventListener('click', function(e) {
            
            // CRITICAL FIX: Block triple click if any modal is currently visible (i.e. blocking screen interaction)
            if (!document.getElementById('message-modal').classList.contains('hidden') || 
                !document.getElementById('admin-key-modal').classList.contains('hidden')) {
                return; 
            }

            const currentTime = new Date().getTime();

            if (currentTime - lastClickTime < TRIPLE_CLICK_INTERVAL) {
                clickCount++;
            } else {
                // If clicks are too slow, reset the counter
                clickCount = 1;
            }

            lastClickTime = currentTime;

            if (clickCount === 3) {
                clickCount = 0; // Reset counter after successful triple-click
                
                const adminPanel = document.getElementById('admin-panel');
                
                if (isAdminLoggedIn) {
                    // If already logged in, just toggle the panel visibility
                    adminPanel.classList.toggle('hidden');
                } else {
                    // If not logged in, show the key input modal
                    openModal('admin-key-modal');
                    document.getElementById('admin-key-input').value = ''; 
                    document.getElementById('admin-key-input').focus();
                }
            }
        });

        // Handle Admin Key Submission
        document.getElementById('admin-key-submit').addEventListener('click', function() {
            const keyInput = document.getElementById('admin-key-input').value.trim();

            if (keyInput === CREATOR_ADMIN_KEY) {
                isAdminLoggedIn = true;
                closeModal('admin-key-modal'); // Use the closing function to restore scroll
                document.getElementById('admin-panel').classList.remove('hidden');

                // Start fetching data only when the Admin Key is correct
                setupAdminDataListener();
            } else {
                showMessage("‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏π‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
                document.getElementById('admin-key-input').value = ''; // Clear wrong key
            }
        });
    </script>
</body>
</html>

